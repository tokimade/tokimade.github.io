<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>tokimade's collage</title>
	<link href="assets/images/icon.jpg" rel="icon" type="image/png">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Quicksand:wght@400;500;600&family=Anton&family=Cormorant+Garamond:ital,wght@1,500;1,600&family=Playball&display=swap" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Passions+Conflict&family=Qwitcher+Grypen:wght@400;700&display=swap" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Passions+Conflict&family=Qwitcher+Grypen:wght@400;700&display=swap" rel="stylesheet">
	
	<style>
    :root {
      --bg: #f9f9fb;
      --fg: #1c1d24;
      --muted: #7b7f99;
      --blush: #f3b6d8;
      --lavender: #d6d9ff;
      --mint: #dff5ea;
      --glow: rgba(190,170,255,.45);
    }

    * { box-sizing: border-box; }

    html, body {
		margin: 0;
		width: 100%;
		height: 100%;
		overflow: hidden;
		font-family: 'Inter', system-ui, sans-serif;
		color: var(--fg);
		-ms-overflow-style: none;  /* IE and Edge */
		scrollbar-width: none; 
    }
	
	.html::-webkit-scrollbar {
		display: none;
	}
	
    .canvas {
		position: relative;
		width: 100vw;
		height: 100vh;
    }
	
	.canvas-inner {
	  position: relative;
	  width: 1920px;
	  height: 1080px;
	}

    /* ===== DRAGGABLE ELEMENT ===== */
    .element {
      position: absolute;
      cursor: grab;
    }

    .element:active { cursor: grabbing; }

    /* ===== TITLE / PROFILE ===== */
    .title {
      top: 6%;
      left: 6%;
      right: auto;
      transform: rotate(-1deg);
    }

    .title img {
      width: 96px;
      height: 96px;
      border-radius: 18px;
      display: block;
      margin-bottom: 10px;
    }

    .title h1 {
      margin: 0;
      font-size: 300px;  
	  font-family: "Qwitcher Grypen", cursive;
  font-weight: 700;
  font-style: normal;
      color: #ff5c9a;
      letter-spacing: 0.02em;
    }

    /* ===== TRACKS ===== */
    .track { width: 380px; }
    .track.big { width: 460px; z-index: 5; }
    .track.bigger { width: 720px; z-index: 10; }

    .track.one   { transform: rotate(-3deg); z-index: 2; }
    .track.two   { transform: rotate(1deg);  z-index: 5; }
    .track.three { transform: rotate(4deg);  z-index: 1; }
    .track.four  { transform: rotate(-2deg); z-index: 1; }
	.track.five  { transform: rotate(1deg); z-index: 0; }
	.track.six  { transform: rotate(-2deg); z-index: 1; }
	.track.seven  { transform: rotate(10deg); z-index: 6;}
	.track.eight  { transform: rotate(1deg); z-index: 0;}
	.track.nine  { transform: rotate(-5deg); z-index: 0;}
	.track.ten  {  transform: rotate(-3deg); z-index: 0;}
	.track.eleven  { transform: rotate(0deg); z-index: -1;}
	.track.twelve  { transform: rotate(2deg); z-index: 0;}
	.track.t3  { transform: rotate(3deg); z-index: 0;}
	.track.t4  { transform: rotate(5deg); z-index: 0;}
	.track.t5  {transform: rotate(-8deg); z-index: 0;}
	.track.t6  { transform: rotate(0deg); z-index: 0;}
	.track.t7  {  transform: rotate(0deg); z-index: -1;}
	.track.t8  {  transform: rotate(-2deg); z-index: 0;}
	.track.t9  {  transform: rotate(2deg); z-index: -1;}

    .track h3 {
      position: absolute;
      bottom: -18px;
      left: -40px;
      margin: 0;
      font-size: 30px;
      font-family: "BBH Bartle", sans-serif;
  font-weight: 700;
  font-style: normal;
      letter-spacing: 0.02em;
      text-transform: uppercase;
      text-shadow: 0 0px 40px rgba(0,0,0,0.07);
      pointer-events: none;
      z-index: 4;
    }


    .track.one h3   { color: #ffd6a5; }
    .track.two h3   { color: #cdb4ff; }
    .track.three h3 { color: #ffffff; }
    .track.four h3  { color: #ffcfd2; }
    .track.five h3  { color: #5fcfdf; }
    .track.six h3  { color: #efefdf; }
    .track.seven h3  { color: #000000; }
    .track.eight h3  { color: #2ba0e4; }
    .track.nine h3  { color: #0000ff; }
    .track.ten h3  { color: #ffcf30; }
    .track.eleven h3  { color: #80463c; }
    .track.twelve h3  { color: #a4dbca; }
    .track.t3 h3  { color: #d4242a; }
    .track.t4 h3  { color: #51d94c; }
    .track.t5 h3  { color: #471ee8; }
    .track.t6 h3  { color: #b6abdb; }
    .track.t7 h3  { color: #faa5ba; }
    .track.t8 h3  { color: #f740ae; }
    .track.t9 h3  { color: #222222; }
    

    .track p {
      margin: 0;
      font-size: 12px;
      color: var(--muted);
    }

    /* ===== ARTWORK ===== */
    .art {
      width: 100%;
      aspect-ratio: 16 / 9;
      object-fit: cover;
      display: block;
    }
	
	.artsqr {
      width: 100%;
	  scale: 134%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      display: block;
    }
	
    /* Hover: glow + play icon */
    .track:hover .art-wrap {
      box-shadow: 0 20px 45px var(--glow);
	  transition: 0.5s ease;
    }

	.art-wrap {
	  position: relative;
	  overflow: hidden;
	  border-radius: 18px;
	  transition: 0.25s ease;
	}

	/* soft dark overlay */
	.art-wrap::after {
	  content: "";
	  position: absolute;
	  inset: 0;
	  background: rgba(0, 0, 0, 0.35);
	  opacity: 0;
	  transition: opacity 0.25s ease;
	  pointer-events: none;
	}

	/* play button */
	.play {
	  position: absolute;
	  inset: 0;
	  display: flex;
	  align-items: center;
	  justify-content: center;

	  font-size: 4em;
	  color: white;
		background: radial-gradient(circle at center, rgba(0,0,0,.15), transparent 70%);
	  opacity: 0;
	  transform: scale(0.9);
	  transition:
		opacity 0.25s ease,
		transform 0.25s ease;

	  pointer-events: none;
	  z-index: 2;
	}

	/* hover trigger */
	.track:hover .art-wrap::after {
	  opacity: 1;
	}

	.track:hover .play {
	  opacity: 1;
	  transform: scale(1);
	}
   

    /* ===== ABOUT ===== */
    .about {
      top: 32%;
      left: 42%;
      right: auto;
      width: 400px;
      transform: rotate(1deg);
    }

    .about h2 {
      margin: 0 0 10px;
      font-size: 28px;
      font-weight: 600;
      font-family: 'Cormorant Garamond', serif;
    }

    .about p {
      font-size: 17px;
      color: var(--muted);
      line-height: 1.7;
      font-family: 'Quicksand', sans-serif;
    }

    /* ===== CTA ===== */
    .cta {
      bottom: 14%;
      right: 6%;
      width: 380px;
      transform: rotate(-1.5deg);
    }

    .cta p {
      font-size: 17px;
      color: var(--muted);
      margin-bottom: 16px;
    }

    .buttons { display: flex; gap: 10px; }

    .btn {
      padding: 14px 26px;
      border-radius: 999px;
      font-size: 15px;
      font-weight: 600;
      font-family: 'Quicksand', sans-serif;
      border: none;
      cursor: pointer;
    }

    .btn.primary {
      background: linear-gradient(120deg, var(--blush), var(--lavender));
      color: #2a2c3a;
	  text-decoration: none;
    }

    .btn.secondary {
      background: white;
      border: 1px solid rgba(0,0,0,.08);
      color: var(--fg);
	  text-decoration: none;
    }

    /* ===== RESET ===== */
    #resetBtn {
      position: fixed;
      bottom: 16px;
      right: 16px;
      z-index: 50;
    }

    #saveDefaultBtn {
      position: fixed;
      bottom: 16px;
      right: 150px;
      z-index: 50;
    }

    #exportLayoutBtn {
      position: fixed;
      bottom: 16px;
      right: 300px;
      z-index: 50;
    }
  
    /* paper texture overlay */
    .paper-texture {
      position: absolute;
      inset: 0;
      background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      opacity: 0.18;
      pointer-events: none;
      z-index: 2;
    }

    .art-wrap { position: relative; }
    .art-wrap img { position: relative; z-index: 1; }
	
#viewToggleBtn {
  position: fixed;
  top: 16px;
  right: 16px;
  z-index: 100;

  width: 8vw;
  height: 12vh;

  display: flex;
  align-items: center;
  justify-content: center;

  font-family: 'BBH Bartle', sans-serif;
  font-size: 14px;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;

  background: #ff5c9a; /* strong identity color */
  color: #ffffff;

  border: none;
  border-radius: 14px;
  cursor: pointer;

  box-shadow:
    0 12px 28px rgba(0, 0, 0, 0.18),
    inset 0 1px 0 rgba(255, 255, 255, 0.25);

  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease,
    background 0.2s ease;
}#viewToggleBtn:hover {
  transform: translateY(-2px);
  box-shadow:
    0 18px 36px rgba(0, 0, 0, 0.22),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

#viewToggleBtn:active {
  transform: translateY(0);
  box-shadow:
    0 8px 18px rgba(0, 0, 0, 0.2),
    inset 0 2px 6px rgba(0, 0, 0, 0.2);
}


#viewToggleBtn.atlas {
  background: #1c1d24; /* dark mode feel */
  color: #ffffff;
}

.canvas-inner {
  transition: transform 0.5s ease;
}
@keyframes viewToggleIntro {
  0% {
    opacity: 0;
    transform: translateY(-12px) scale(0.85);
  }
  60% {
    opacity: 1;
    transform: translateY(0) scale(1.05);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

#viewToggleBtn {
  opacity: 0; /* start hidden */
  animation: viewToggleIntro 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
  animation-delay: 1.2s;
}
/* ===== POPUP (ANIMATED) ===== */
.popup-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.65);

  display: flex;
  align-items: center;
  justify-content: center;

  opacity: 0;
  pointer-events: none;
  transition: opacity 0.35s ease;
  z-index: 9999;
}

.popup-overlay.active {
  opacity: 1;
  pointer-events: auto;
}

.popup-box {
  background: #ffffff;
  width: min(90%, 420px);
  padding: 28px 32px;
  border-radius: 18px;
  box-shadow: 0 30px 80px rgba(0, 0, 0, 0.35);

  transform: scale(0.92) translateY(10px);
  opacity: 0;
  transition:
    transform 0.35s cubic-bezier(0.22, 1, 0.36, 1),
    opacity 0.25s ease;
  position: relative;
  font-family: 'Inter', system-ui, sans-serif;
}

.popup-overlay.active .popup-box {
  transform: scale(1) translateY(0);
  opacity: 1;
}

.popup-box h2 {
  margin-top: 0;
  font-family: 'Cormorant Garamond', serif;
  font-size: 28px;
}

.popup-box p {
  font-size: 15px;
  line-height: 1.6;
  color: var(--muted);
}

.popup-close {
  position: absolute;
  top: 14px;
  right: 16px;
  border: none;
  background: none;
  font-size: 28px;
  cursor: pointer;
}
.hidden{
opacity:0;
cursor:none;

}

  </style>
</head>

<body>

<button id="viewToggleBtn" class="btn secondary">Atlas</button>
<p id="exportLayoutBtn" class="hidden"></p>
<p id="saveDefaultBtn" class="hidden"></p>
<button id="resetBtn" class="btn secondary">Reset layout</button>

<div class="canvas">
<div class="canvas-inner">
  <!-- PROFILE -->
  
  <div class="element title" data-id="title">
    <h1>tokimade.</h1>
  </div>

  <!-- ABOUT -->
  <div class="element about" data-id="about">
    <h2>About</h2>
	<p>♫ Producer ► Mix&Master • Sound Clean-up<br>♪ Audio Guidance</p>
    <p>music producer exploring sounds. explosive emotion palette of sounds</p>
  </div>

  <!-- TRACK 1: Wireframe -->
  <div class="element track one" data-id="wireframe" data-url="https://youtu.be/OLuwDuB8M4g">
    <div class="art-wrap">
      <div class="paper-texture"></div>
      <img class="artsqr" src="https://i.ytimg.com/vi/OLuwDuB8M4g/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>ワイヤーフレーム</h3>
  </div>

  <!-- TRACK 2: Heartwrencher (big) -->
  <div class="element track big two" data-id="heartwrencher" data-url="https://youtu.be/9EbBn2eKB8g">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/9EbBn2eKB8g/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Heartwrencher</h3>
  </div>

  <!-- TRACK 3: Aishite -->
  <div class="element track three" data-id="aishite" data-url="https://youtu.be/utCOQsuoHF8">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/utCOQsuoHF8/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>愛して愛して愛して [Jazz Fusion Rearrangement]</h3>
  </div>

  <!-- TRACK 4: Oto no Naru Hou e -->
  <div class="element track four" data-id="otononaru" data-url="https://youtu.be/eQR7CZfqy_o">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/eQR7CZfqy_o/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>オトノナルホウヘ</h3>
  </div>

<!-- TRACK 5: Between Blue & Sky -->
  <div class="element track five" data-id="betweenblueandsky" data-url="https://youtu.be/b0UiNKq9ffw">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/b0UiNKq9ffw/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Between Blue & Sky</h3>
  </div>
  
 <!-- TRACK 6: Day 1, The End -->
  <div class="element track six" data-id="day1theend" data-url="https://youtu.be/qdp6l4XVJL4">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/qdp6l4XVJL4/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Day 1, The End</h3>
  </div>
  
<!-- TRACK 7: E.V.A. -->
  <div class="element track seven" data-id="eva" data-url="https://youtu.be/aNe8VNOofKA">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/aNe8VNOofKA/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>E.V.A.</h3>
  </div>

<!-- TRACK 8: yours, truly -->
  <div class="element track eight" data-id="yourstruly" data-url="https://youtu.be/KnNlCYk4uH0">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/KnNlCYk4uH0/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>yours, truly</h3>
  </div>

<!-- TRACK 9: mentalism-->
  <div class="element track nine" data-id="mentalism" data-url="https://youtu.be/86bX4FZEETU">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/86bX4FZEETU/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>M3NT4L1SM</h3>
  </div>

<!-- TRACK 10: what a shitshow-->
  <div class="element track ten" data-id="shitshow" data-url="https://youtu.be/0vF-h3Ee4C0">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/0vF-h3Ee4C0/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>What a Shitshow!</h3>
  </div>

<!-- TRACK 11: Mister-->
  <div class="element track eleven" data-id="mister" data-url="https://youtu.be/-m8ic24tIwQ">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/-m8ic24tIwQ/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Mister</h3>
  </div>
  
<!-- TRACK 12: Your only writer-->
  <div class="element track twelve" data-id="yol" data-url="https://youtu.be/KeTI7IvZN2Y">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/KeTI7IvZN2Y/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Your Only Writer</h3>
  </div>
  
<!-- TRACK 13: no, thank you!-->
  <div class="element track t3" data-id="nty" data-url="https://youtu.be/4sKHFofY6HE">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/4sKHFofY6HE/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>NO, Thank you! [Metal Rearrangement]</h3>
  </div>

<!-- TRACK 14: Rosse Banquet-->
  <div class="element track t4" data-id="rosse" data-url="https://youtu.be/CKr7m2I2Yr8">
    <div class="art-wrap">
      <img class="artsqr" src="https://i.ytimg.com/vi/CKr7m2I2Yr8/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Rosse Banquet</h3>
  </div>

<!-- TRACK 15: Nightingal-->
  <div class="element track t5" data-id="nightingal" data-url="https://youtu.be/Smz28FDBI54">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/Smz28FDBI54/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Nightingal</h3>
  </div>

<!-- TRACK 16: VLIS-->
  <div class="element track bigger t6" data-id="VLIS" data-url="https://youtu.be/8tSj2URemmw">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/8tSj2URemmw/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Vivi's Lavender & Ivalette's Secret</h3>
  </div>

<!-- TRACK 17: Polliet-->
  <div class="element track big t7" data-id="polliet" data-url="https://youtu.be/5YlrxaX2AKM">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/5YlrxaX2AKM/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>P-OLLIET</h3>
  </div>

<!-- TRACK 18: Calavera-->
  <div class="element track t8" data-id="Calavera" data-url="https://youtu.be/nH5GT11O9jc">
    <div class="art-wrap">
      <img class="art" src="https://i.ytimg.com/vi/nH5GT11O9jc/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>Calavera</h3>
  </div>

<!-- TRACK 19: 4Rs-->
  <div class="element track t9" data-id="Ars" data-url="https://youtu.be/nAc36abxew8">
    <div class="art-wrap">
      <img class="artsqr" src="https://i.ytimg.com/vi/nAc36abxew8/hqdefault.jpg" />
      <div class="play">▶</div>
    </div>
    <h3>4Rs</h3>
  </div>

  <!-- STUFF -->
  <div class="element cta" data-id="cta">
    <p>open for collaborations and commission works.</p>
    <div class="buttons">
      <a class="btn primary" href="detail.html">More Detail</a>
      <a class="btn secondary" href="#" id="openPopup">Contact</a>
    </div>
  </div>
  
</div>
<!-- POPUP OVERLAY -->
<div id="popupOverlay" class="popup-overlay">
  <div class="popup-box">
    <button class="popup-close">&times;</button>

    <h2>Contact</h2>
    <p>
      I only accept commissions through these platforms<br><br>
      Twitter: @tokimade<br>
	  Discord: @tokimade<br>
	  E-mail: tokimade.p@gmail.com
    </p>
  </div>
</div>
<script>

const elements = [...document.querySelectorAll('.element')];

let viewMode = 'canvas';
const VIEW_SCALES = { canvas: 1, atlas: 0.6 };

const DESIGN_WIDTH = 1920;
const DESIGN_HEIGHT = 1080;

/* ===============================
   AUTHORITATIVE INITIAL LAYOUT
================================ */
const INITIAL_LAYOUT = {
  title: { x: 178, y: 54 },
  about: { x: 633, y: 395 },
  wireframe: { x: 1176, y: 298 },
  heartwrencher: { x: 1031, y: 78 },
  aishite: { x: 360, y: 660 },
  otononaru: { x: 143, y: 445 },
  betweenblueandsky: { x: 2028, y: 10 },
  day1theend: { x: 889, y: 633 },
  eva: { x: 1434, y: 2 },
  mentalism: { x: 139, y: 813 },
  mister: { x: 2075, y: 519 },
  nightingal: { x: 1641, y: 1114 },
  nty: { x: -289, y: 1123 },
  polliet: { x: 871, y: -390 },
  rosse: { x: -423, y: 412 },
  shitshow: { x: 1914, y: -188 },
  yol: { x: 1012, y: 838 },
  yourstruly: { x: 1510, y: 586 },
  VLIS: { x: 55, y: -389 },
  Calavera: { x: 1205, y: 1181 },
  Ars: { x: -526, y: 44 },
  cta: { x: 1485, y: 897 }
};
document.addEventListener("DOMContentLoaded", () => {
  applyLayout(initialLayout);
});
/* ===============================
   LAYOUT STATE (DESIGN SPACE)
================================ */
let layout = JSON.parse(localStorage.getItem('layout')) || structuredClone(INITIAL_LAYOUT);

/* ===============================
   APPLY LAYOUT
================================ */
function applyLayout() {
  elements.forEach(el => {
    const id = el.dataset.id;
    const pos = layout[id];
    if (!pos) return;
    el.style.left = pos.x + 'px';
    el.style.top  = pos.y + 'px';
  });
}

/* ===============================
   SCALE VIEW (VISUAL ONLY)
================================ */
function scaleCanvas() {
  const canvas = document.querySelector('.canvas');
  const inner = document.querySelector('.canvas-inner');

  const vw = canvas.clientWidth;
  const vh = canvas.clientHeight;

  const scale = (vw / DESIGN_WIDTH) * VIEW_SCALES[viewMode];

  const offsetX = (vw - DESIGN_WIDTH * scale) / 2;
  const offsetY = (vh - DESIGN_HEIGHT * scale) / 2;

  inner.style.transform = `
    translate(${offsetX}px, ${offsetY}px)
    scale(${scale})
  `;
  inner.style.transformOrigin = 'top left';

  return scale;
}

/* ===============================
   DRAGGING (TRANSFORM SAFE)
================================ */
let active = null;
let startX = 0, startY = 0;
let originX = 0, originY = 0;
let currentScale = 1;

elements.forEach(el => {
  el.addEventListener('mousedown', e => {
    active = el;
    const id = el.dataset.id;

    currentScale = scaleCanvas();
    startX = e.clientX;
    startY = e.clientY;
    originX = layout[id].x;
    originY = layout[id].y;

    el.style.zIndex = 50;
    e.preventDefault();
  });
});

document.addEventListener('mousemove', e => {
  if (!active) return;

  const id = active.dataset.id;
  layout[id].x = originX + (e.clientX - startX) / currentScale;
  layout[id].y = originY + (e.clientY - startY) / currentScale;

  applyLayout();
});

document.addEventListener('mouseup', () => {
  if (!active) return;
  active.style.zIndex = '';
  localStorage.setItem('layout', JSON.stringify(layout));
  active = null;
});

/* ===============================
   RESET (TRUE RESET)
================================ */
document.getElementById('resetBtn').onclick = () => {
  layout = structuredClone(INITIAL_LAYOUT);
  localStorage.removeItem('layout');
  applyLayout();
  scaleCanvas();
};

/* ===============================
   VIEW TOGGLE
================================ */
document.getElementById('viewToggleBtn').onclick = () => {
  viewMode = viewMode === 'canvas' ? 'atlas' : 'canvas';
  document.getElementById('viewToggleBtn').textContent =
    viewMode === 'canvas' ? 'Atlas' : 'Canvas';
  scaleCanvas();
};

/* ===============================
   BOOT
================================ */
applyLayout();
scaleCanvas();
window.addEventListener('resize', scaleCanvas);

  // Toggle Zoom
const viewToggleBtn = document.getElementById('viewToggleBtn');

viewToggleBtn.onclick = () => {
  viewMode = viewMode === 'canvas' ? 'atlas' : 'canvas';

  viewToggleBtn.textContent =
    viewMode === 'canvas' ? 'Atlas' : 'Canvas';

  scaleCanvas();
};

  // OPEN YOUTUBE
  document.querySelectorAll('.track').forEach(t => {
    t.addEventListener('dblclick', () => window.open(t.dataset.url, '_blank'));
  });
  
  // ===== POPUP (ANIMATED) =====
const openPopup = document.getElementById('openPopup');
const popupOverlay = document.getElementById('popupOverlay');
const popupClose = popupOverlay.querySelector('.popup-close');

openPopup.addEventListener('click', (e) => {
  e.preventDefault();
  popupOverlay.classList.add('active');
});

function closePopup() {
  popupOverlay.classList.remove('active');
}

popupClose.addEventListener('click', closePopup);

// Close when clicking outside the popup
popupOverlay.addEventListener('click', (e) => {
  if (e.target === popupOverlay) closePopup();
});


window.addEventListener('resize', scaleCanvas);
  window.addEventListener('load', scaleCanvas);

</script>


</body>
</html>
